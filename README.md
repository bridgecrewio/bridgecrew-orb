# Bridgecrew Orb for CircleCI

## The Bridgecrew Orb

Use the Bridgecrew orb to scan for infrastrcture-as-code errors in your CircleCI Workflows.
By utilizing this orb in your project workflow, you can automatically start to find,
fix and monitor your project for configuration errors in Terraform and CloudFormation. 
By signing up for a free Bridgecrew Community plan you can also view dashboards and reports. 
The community plan does not limit the number of scans or users you can invite to view the results.
â€‹
## How to use the Bridgecrew Orb

In fact, it is very easy to start using the Orb.
All you need to do is:

1. Follow the instructions at the [Orb Quick Start Guide](https://circleci.com/orbs/registry/orb/bridgecrew/bridgecrew#quick-start) to enable usage of Orbs in your project workflow.
2. Set up an environment variable with your Bridgecrew API token, which you can get from your [Bridgecrew account](https://www.bridgecrew.cloud/integrations).
3. In the app build job, call the `bridgecrew/scan`
4. Optionally, supply parameters to customize orb behaviour

## Usage Examples

### Scan IaC Directory

```yaml
version: 2.1

  orbs:
    bridgecrew: bridgecrew/bridgecrew@x.y.z

  jobs:
    build:
      executor: bridgecrew/default
      steps:
        - checkout
        - bridgecrew/scan:
            directory: './terraform'
            soft-fail: true
            output: "junitxml"
            api-key: "6bridgecrew-9example-2api-key1-demo9"
            repo-id: "bridgecrewio/terragoat"
```

### Scan IaC Files

```yaml
version: 2.1

orbs:
  bridgecrew: bridgecrew/bridgecrew@x.y.z

jobs:
  build:
    executor: bridgecrew/default
    steps:
      - checkout
      - bridgecrew/scan:
          file: "./terraform/db-app.tf"
          output: "json"
          api-key: "6bridgecrew-9example-2api-key1-demo9"
          repo-id: "bridgecrewio/terragoat"
```

### Advanced Example

```yaml
version: 2.1

orbs:
bridgecrew: bridgecrew/bridgecrew@x.y.z

jobs:
build:
    executor: bridgecrew/default
    steps:
    - checkout
    - bridgecrew/scan:
        directory: "./terragoat"                          # tell bridgecrew where is the directory you want to scan
        soft-fail: true                                   # do not fail the workflow in case vulnerabilities have found 
        output: "cli"                                     # apply pactches specified in commited .snyk file (generated by running the [snyk wizard](https://snyk.io/docs/cli-wizard/))
        api-key: "6bridgecrew-9example-2api-key1-demo9"   # use bridgecrew api key to create violations in bridgecrew app
        repo-id: "bridgecrewio/terragoat"                 # required when using api-key
```

## Orb Parameters

Full reference docs https://circleci.com/orbs/registry/orb/bridgecrew/bridgecrew

| Parameter  | Description | Required | Default | Type |
| -----------| -------------------------------------------------------------------------------------------------------- | ------------- | ------------- | ------------- |
| api-token | API token from Bridgecrew app | no | "none" | string |
| repo-id | Repository for bridgecrew to scan | when providing api-key | "none" | string |
| branch | Branch within the repository for bridgecrew to scan | no | "master" | string |
| directory | IaC root directory to scan | no | "none" | string |
| file | IaC file to scan | no | "none" | string |
| soft-fail | Runs checks but suppresses error code | no | false | boolean |
| output | Report output format | no | "cli" | cli \ json \ junitxml |

## Screenshots

